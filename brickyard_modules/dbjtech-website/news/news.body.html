<div id="title">公司动态</div>

<script
	src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"
	integrity="sha256-4iQZ6BVL4qNKlQ27TExEhBN1HFPvAvAMbFavKKosSWQ="
	crossorigin="anonymous"
></script>
<script>
	$.get('https://linketech-website.linketech.now.sh/news').done(function(res) {
		var newsDataList = res.data.filter(function(item) {
			return item.project === 'dbj'
		})

		newsDataList.forEach(function(item) {
			var titleNode = $('<h2></h2>').text(item.title)
			var dateNode = $('<p class="info"></p>').text(
				'发布日期：' + moment(item.timestamp * 1000).format('YYYY-MM-DD'),
			)
			var summaryNode = $('<p class="abstract"></p>').text(item.summary)

			var detailNode = $('<a class="readmore">查看全文</a>').click(function() {
				// 防止 content 为 null
				var replacedContent = new String(item.content).replace(
					// 不能用正则字面量，因为 webpack 编译时会转义 \/ 变为 /，无法正常匹配
					new RegExp('src="\\/img', 'g'),
					'src="https://linketech-website.linketech.now.sh/img',
				)
				var contentNode = $(replacedContent)

				var returnButton = $(
					'<a class="btn btn-default btn-md" type="button">返回</a>',
				).click(function() {
					$('#news-list-container').show()
					$('#news-detail-container').html('')
				})
				var buttonContainer = $(
					'<div class=" col-md-offset-5 col-md-2"></div>',
				).append(returnButton)
				var separatorMdNode = $('<div class="separator-md"></div>')
				var buttonRow = $('<div class="row"></div>').append(buttonContainer)
				var separatorLgNode = $('<div class="separator-lg"></div>')

				var newsDetailNode = $('<div id="news-detail"><div>').append(
					// 防止 news-list-container 中的节点实例转移到 news-detail-container 中
					titleNode.clone(),
					dateNode.clone(),
					contentNode,
					separatorMdNode,
					buttonRow,
					separatorLgNode,
				)

				$('#news-list-container').hide()
				$('#news-detail-container').append(newsDetailNode)
			})

			var newsItemNode = $(
				'<div class="col-xs-12 recent wow fadeInUp"></div>',
			).append(titleNode, dateNode, summaryNode, detailNode)
			$('#news-list').append(newsItemNode)
		})
	})
</script>

<div id="news">
	<div class="container-fluid">
		<div class="row">
			<img class="full-width" src="img/news.jpg" />
		</div>
	</div>

	<div id="news-list-container" class="container">
		<div class="separator-lg"></div>
		<p class="h1 wow fadeInUp">
			热<span class="line-lightgray-bold">点新</span>闻
		</p>
		<div class="separator-md"></div>

		<div class="row">
			<div class="col-md-4 hotnews wow fadeIn">
				${require('html-loader!./annual-meeting/article.html')}
			</div>
			<div class="col-md-4 hotnews wow fadeIn" data-wow-delay="0.5s">
				${require('html-loader!./exchange/article.html')}
			</div>
			<div class="col-md-4 hotnews wow fadeIn" data-wow-delay="1s">
				${require('html-loader!./interview-gdtv/article.html')}
			</div>
		</div>

		<div class="separator-lg"></div>
		<p class="h1 wow fadeInUp">
			近<span class="line-lightgray-bold">期新</span>闻
		</p>
		<div class="separator-lg"></div>

		<div id="news-list" class="row"></div>

		<div class="separator-lg"></div>
	</div>

	<div id="news-detail-container" class="container"></div>
</div>
